/**
 * FamilyDao.java
 * com.snail.dao
 *
 * Function锛� TODO 
 *
 *   ver     date      		author
 * 鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�鈹�
 *   		 2016骞�1鏈�27鏃� 		Stone
 *
 * Copyright (c) 2016, TNT All Rights Reserved.
*/

package com.snail.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import com.snail.utils.DBconnection;

/**
 * ClassName:FamilyDao
 * Function: 鏌ヨ鏁版嵁搴撶被
 * Reason:	 TODO ADD REASON
 *
 * @author   Stone
 * @version  
 * @since    Ver 1.1
 * @Date	 2016骞�1鏈�27鏃�		涓嬪崍4:42:24
 *
 * @see 	 
 */
public class FamilyDao {
	
	/*
	 * 澧炲姞瀹跺涵鎴愬憳
	 */
	public void faAdd(Family family)
	{
		Connection conn = null;
		PreparedStatement ps = null;
		try 
		{
		//杩炴暟鎹簱
		conn = DBconnection.getConnection();
		//sql璇彞
		String sql = "insert into familymember(fm_id,fm_name,fm_user_name,fm_permiss,pwd)+values(?,?,?,?,?);";
		//鑾峰緱prepareddtatement瀵硅薄
		ps = conn.prepareStatement(sql);
		//璁剧疆 ?銆�鐨勫��
		ps.setInt(1,family.getFm_Id());
		ps.setString(2,family.getRealName());
		ps.setString(3, family.getUserName());
		ps.setInt(4, family.getPermiss());
		ps.setString(5,family.getPwd());
		} 
		catch (Exception e) 
		{
			//鎶涘嚭寮傚父
			throw new RuntimeException(e);
		}
		finally
		{
			//鍏抽棴璧勬簮
			if(conn!=null)
				try 
				{
					conn.close();
				} 
				catch (SQLException e) 
				{
					throw new RuntimeException(e);
				}
			if(ps!=null)
				try
				{
					ps.close();
				} 
				catch (SQLException e) 
				{
					throw new RuntimeException(e);
				}
		}
	}
	
	/*
	 * 閫氳繃鎴愬憳id鑾峰彇淇℃伅
	 */
	public Family getFamilyById(int id) throws Exception
	{
		Connection conn = DBconnection.getConnection();
		String sql = "select * from familymember where fm_id=?";
		PreparedStatement ps = conn.prepareStatement(sql);
		ps.setInt(1, id);
		ResultSet rs = ps.executeQuery();
		//鍒涘缓涓�涓搴垚鍛樺璞�
		Family er = new Family();
		//鍙栧埌鏁版嵁,瑁呭埌涓�涓鐢熷璞�
		if(rs.next())
		{
			er.setFm_Id(rs.getInt("fm_id"));
			er.setUserName(rs.getString("userName"));
			er.setRealName(rs.getString("realName"));
			er.setPwd(rs.getString("pwd"));
			er.setPermiss(rs.getInt("permiss"));
		}
		return er;
	}
	
	
	
	/*
	 * 淇敼瀹跺涵鎴愬憳淇℃伅
	 */
	public Family update(Family f)
	{
		
		
		
	}
	
	
	
	
	
	
	/*
	 * 閫氳繃id 鍒犻櫎瀹跺涵鎴愬憳淇℃伅
	 */
	public void delete(int[] id)
	{
		//sql璇彞
		String sql = "delete from familymember where id in(";
		
		for(int i=0;i<id.length;i++)
		{
			sql+=id[i];
			if(i<id.length-1)
			{
				sql+=",";
			}
		}
		sql=sql+");";
	}
	
	/*
	 * 鑾峰緱鍏ㄩ儴瀹跺涵鎴愬憳淇℃伅
	 */
	public List<Family> getAll()
	{
		Connection conn = null;
		PreparedStatement ps = null;
		ResultSet rs = null;
		List<Family> family = new ArrayList<Family>();
		try
		{
			conn = DBconnection.getConnection();
			String sql = "select * from familymember";
			ps = conn.prepareStatement(sql);
			rs = ps.executeQuery();
			
			if(rs.next())
			{
				Family f = new Family();
				f.setFm_Id(rs.getInt("id"));
				f.setPermiss(rs.getInt("permiss"));
				f.setPwd(rs.getString("pwd"));
				f.setRealName(rs.getString("realName"));
				f.setUserName(rs.getString("userName"));
				
				family.add(f);
			}
		}
		catch(Exception e)
		{
			throw new RuntimeException(e);
		}
		finally
		{
			try {
				conn.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
			try {
				rs.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
			try {
				ps.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
		}
		return family;
	}
	
	/*
	 * 淇敼瀹跺涵鎴愬憳淇℃伅 
	 */
	public void update(Family f)
	{
		
	}
	
	//娣诲姞璐﹀崟
	//鍒犻櫎璐﹀崟
	//淇敼璐﹀崟
	
	//娣诲姞鎴愬憳
	//淇敼鎴愬憳
	//鍒犻櫎鎴愬憳
	
	//娣诲姞璐﹀崟鐖堕」
	
	
	//鏂板璐﹀崟瀛愰」
	
	
	//鍒犻櫎
	
	
	
	

}

